<div class="app-container">
    
    <!-- Mobile Overlay -->
    <div class="mobile-overlay" [class.show]="isMobileMenuOpen" (click)="closeMobileMenu()"></div>

    <!-- SIDEBAR -->
    <aside class="sidebar" [class.open]="isMobileMenuOpen">
        <div class="brand">
            <h2>Vendor<span class="highlight">Portal</span></h2>
            <button class="close-btn" (click)="closeMobileMenu()">&times;</button>
        </div>

        <nav class="nav-links">
            <!-- DASHBOARD -->
            <a routerLink="/dashboard" routerLinkActive="active" class="nav-item" (click)="closeMobileMenu()">
                <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
                <span>Dashboard</span>
            </a>

            <!-- PURCHASE ORDERS -->
            <a routerLink="/purchase-orders" routerLinkActive="active" class="nav-item" (click)="closeMobileMenu()">
                <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>
                <span>Purchase Orders</span>
            </a>

            <!-- RFQs -->
            <a routerLink="/rfq" routerLinkActive="active" class="nav-item" (click)="closeMobileMenu()">
                <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                <span>RFQs</span>
            </a>

            <!-- GOODS RECEIPT -->
            <a routerLink="/goods-receipt" routerLinkActive="active" class="nav-item" (click)="closeMobileMenu()">
                <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="3" width="15" height="13"></rect><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon><circle cx="5.5" cy="18.5" r="2.5"></circle><circle cx="18.5" cy="18.5" r="2.5"></circle></svg>
                <span>Goods Receipt</span>
            </a>

            <!-- FINANCE -->
            <a routerLink="/finance" routerLinkActive="active" class="nav-item" (click)="closeMobileMenu()">
                <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                <span>Financial Sheet</span>
            </a>

            <!-- PROFILE -->
            <a routerLink="/profile" routerLinkActive="active" class="nav-item" (click)="closeMobileMenu()">
                <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                <span>Profile</span>
            </a>
        </nav>

        <ng-container *ngIf="profile; else profileFallback">
            <div class="user-profile">
                <div class="profile-main">
                    <div class="avatar">{{ profileInitials }}</div>
                    <div>
                        <p class="user-name">{{ profile.name || 'Vendor Partner' }}</p>
                        <p class="user-meta">{{ profile.city && profile.country ? (profile.city + ', ' + profile.country) : profileSubtitle }}</p>
                    </div>
                </div>
                <div class="profile-meta">
                    <span class="status-pill" [class.online]="(profile.status || '').toLowerCase() === 'active'">
                        {{ profile.status || 'Connected' }}
                    </span>
                    <small>ID: {{ profile.vendorId }}</small>
                </div>
                <button (click)="logout()" class="btn-logout">Sign Out</button>
            </div>
        </ng-container>
        <ng-template #profileFallback>
            <div class="user-profile">
                <div class="profile-main">
                    <div class="avatar" [class.loading]="isProfileLoading">{{ profileInitials }}</div>
                    <div>
                        <p class="user-name">{{ profile?.name || 'Vendor Partner' }}</p>
                        <p class="user-meta">{{ profileSubtitle }}</p>
                    </div>
                </div>
                <div class="profile-meta">
                    <span class="status-pill muted">{{ isProfileLoading ? 'Syncing' : 'Offline' }}</span>
                    <small>ID: {{ vendorId || 'â€”' }}</small>
                </div>
                <button (click)="logout()" class="btn-logout">Sign Out</button>
            </div>
        </ng-template>
    </aside>

    <main class="main-content">
        <!-- (Keep your header code here same as before) -->
        <header class="topbar">
            <div class="header-left">
                <button class="hamburger" (click)="toggleMobileMenu()">
                     <!-- Hamburger SVG -->
                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
                </button>
                <h3>Overview</h3>
            </div>
            <div class="date">{{ currentDate | date:'fullDate' }}</div>
        </header>

        <div class="content-wrapper">
            <router-outlet></router-outlet>
        </div>
    </main>
</div>